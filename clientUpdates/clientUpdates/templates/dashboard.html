{% extends 'base_generic.html' %}

{% block content %}

{% if pws.data_origin == 'EHE Forms Portal' %}
<div class="container-mt-4">
    <p>
        Looks like you are in the wrong EH&E portal. This portal is only intended for systems that have already submitted a Phase 1 3M and DuPont claim with the Office of the Claims Administrator. Our records indicate that <b>{{ pws.pws_name }} ({{ pws.pwsid}})</b> has <em>not</em> yet filed a claim. 
    </p>
    <p>
        Perhaps you are looking for <a href="https://app.form.com/online/81596113/?nav=default&login=">EH&E Forms portal</a>, which is designed to receive information for systems that have yet to file a claim. If that is the case, please head over to <a href="https://app.form.com/online/81596113/?nav=default&login=">EH&E Forms portal</a> and login using the same username and password you used to log into this portal. In the Forms portal, you will be able to provide all the relevant information needed to file a claim with the Office of the Claims Administrator for a new system. 
    </p>

    <p>
        We apologize for the confusion. If you have any questions, please <a href="{% url 'contact_default' %}">contact us</a> and one of us at EH&E will be in touch with you within two business days.
    </p>
</div>


{% else %}
<div class="container mt-4">

    <h3 class="no-bottom-border" style="text-align:center; font-weight:bold;">
        {% if claim == "3M_DuPont" %} 3M/Dupont Phase I Supplemental Fund {% else %} Tyco/BASF Supplemental Fund {% endif %}
    </h3>

    <p>
        The table below lists all the sources that were filed by <strong>{{pws.pwsid}}</strong> for the
        {% if claim == "3M_DuPont" %} 3M/Dupont Phase I Action Fund Claim{% else %} Tyco/BASF Action Fund Claim{% endif %}.
        Moreover, the table provides information on whether each source is eligible to file a Supplemental Fund Claim.
    </p>

    <div class="alert alert-primary" style="display:flex">
        <i class="bi bi-info-circle h5" style="padding-right:2px; color:blue; width:5%"></i>

        <div>

            <h5 style="border-bottom: 2px solid rgba(8,66,152,0.25); margin-bottom:10px;">Please note the following:</h5>
            <ol>
                <li>
                    <p>Use the "Submit Notification" button to notify EH&E staff once <strong>{{pws.pwsid}}</strong> is
                    ready to file a Supplemental Fund Claim for an eligible source. This would occur when:</p>

                    <ul>
                        <li style="text-align:left;">A source was "unimpacted" (i.e., there was no measureable concentration
                            of PFAS detected in the water source) at the time of filing the action fund claim but has since
                            exhibited detections of PFAS; OR</li>

                        <br>

                        <li style="text-align:left;">A source exhibited PFAS detections <strong>below</strong> the Proposed Federal PFAS MCLs or applicable State PFAS MCLs at
                                the time of filing the action fund claim, but have since had one or more PFAS detections above the Proposed Federal PFAS MCLs or applicable State PFAS MCLs.</li>
                    </ul>
                </li>

                <br>

<!--                <li>
                    <p>Supplemental Fund Claims can be submitted at any time up to and including December 31, 2030.</p>
                </li>

                <li>
                    <p>A Supplemental Fund Claim can be submitted for each source a maximum of two times.</p>
                </li>-->
            </ol>

            <p>Please refer to our <a style="color:blue;" href="{% url 'supplemental_info' %}">Supplemental Fund Information</a> page for more details on the requirements
            of the Supplemental Funds.</p>


        </div>

    </div>

    <div class="container">
        <h4>Sources</h4>

        <table id="sourcesTable" class="table table-hover table-bordered">
            <thead class="table-light">
                <tr>
                    <th scope="col" class="text-center">Source Name</th>
                    <!--<th scope="col" style="width:20%;">Source Type</th>-->
                    <th scope="col" class="text-center">Source Eligibility</th>
                    <th scope="col" class="text-center">Eligibility Reason</th>
                    <th scope="col" class="text-center">Submit Notification to Proceed</th>
                    <th scope="col" class="text-center">Notification Sent</th>
                    <th scope="col" class="text-center">Supplemental Status</th>
                    <th scope="col" class="text-center">View Source Info</th>
                </tr>
            </thead>
            <tbody>
                {% for source in sources %}
                <tr>
                    <td>{{ source.source_name }}</td>
                    <td class="text-center">{% if not source.reg_bump %} Eligible {% else %} Not Eligible {% endif %}</td>
                    <td class="text-center">{% if source.reg_bump %} PFOA and/or PFOS detections above 4 ppt
                    {% elif not source.reg_bump and source.all_nds %} No PFAS detections {% else %} PFOA and PFOS detections below 4 ppt {% endif %}</td>
                    <td class="text-center">
                        <a href="{% url 'contact_phase1' claim=claim source_name=source.source_name message=1 %}" class="btn btn-primary {%if source.reg_bump or source.sup_notif_sent %}no-click{%endif%}">Submit Notification</a>
                    </td>
                    <td class="text-center">
                        {% if source.sup_notif_sent %} Yes {% else %} No {% endif %}
                    </td>
                    <td class="text-center">
                        {{source.sup_status}}
                    </td>
                    <td class="text-center">
                        <a href="{% url 'source-detail' claim=claim pwsid=source.pwsid source_name=source.source_name %}"
                            class="text-decoration-none"
                            style="color:inherit;">
                            <i class="bi bi-eye-fill h5"></i>
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    
</div>    
{% endif %}

<script>
    $(document).ready(function() {
        $('#sourcesTable').DataTable({
            pageLength: 25, 
            columnDefs: [
                {orderable: false, targets: 3}
            ], 
            order: [
                [0, 'asc']
            ],
        });
    });
</script>

{% endblock %}